---
toc: false
---

# Dealing with APIs 

- APIs (Application Programming Interfaces) allow different software applications to communicate with each other. In web development, APIs are often used to fetch data from a server or send data to a server. 
- We need to make HTTP requests to interact with APIs. Common HTTP methods include GET (to retrieve data), POST (to send data), PUT (to update data), and DELETE (to remove data).
- In React, we typically make API calls inside the `useEffect` hook to ensure that the data is fetched when the component mounts. We can use the built-in `fetch` function or third-party libraries like Axios to make these requests.
- When making API calls, it's important to handle loading states and errors gracefully. This involves setting up state variables to track whether data is being loaded and if any errors occurred during the request.
- We can use async/await syntax to handle asynchronous API calls more cleanly. This allows us to write code that looks synchronous while still being non-blocking.
- For development purposes, we can use mock APIs or tools like JSON Server to simulate backend endpoints. This is especially useful when the actual backend is not yet available or when we want to test our frontend code in isolation. Here, we need to focus on react concepts rather than backend implementation. So the easiest way is to use a mock server. 
- Later we can go with a full fledged firebase or express or supabase backend. 

The easiest way to setup a local server is to use the [JSON server.](https://github.com/typicode/json-server)


**Lets put in everything we have learned till this point.**

- Create a new component Product 
- It should hold 3 states : products (array), loading (boolean), error (string)
- On component mount, fetch products from fakestore api with useEffect and fetch + async await. 
- While fetching, set loading to true and show a loading message
- If fetch is successful, store products in state and set loading to false
- If fetch fails, set error message in state and set loading to false
- Make sure to use try catch for error handling.
- Refactor the CartContainer to accept products as props. 
- Upon completion, we should be able to see products being displayed. 
- Check the network tab in devtools to see the api call in action.
- Make sure, we have 2 terminals running, one for react app and another for json server.

It should function as is, but this time, the data pulled from an external endpoint api. 

[Find the working solution in this commit](https://github.com/thecanadiandev/react-core-fundamentals/commit/caa7169819834e86942a1d25ee7952d56b29020d)

## Using environment variables

In .env file, we need to start with VITE_ to make it work with vite.

```
VITE_API_URL="http://localhost:4000"

// and in component 
const API_URL = import.meta.env.VITE_API_URL;
```

Make sure to add `.env` to `.gitignore`so that it is not pushed to remote repo.

[Find the working solution in this commit](https://github.com/thecanadiandev/react-core-fundamentals/commit/17b5b6a0af09198222912fcd05ca600c349b3bdf)



## JSON Server Pagination, Sorting, and Filtering

JSON Server provides built-in support for pagination, sorting, and filtering through URL query parameters.

We can add pagination by using `_page` parameters. Console the repsonse to see how the data is retrieved. We get a prev/next property that tells us if there is a previous or next page available. For our purpose, we just use one parameter called `_page`.  Feel free to explore more in the [official documentation](https://github.com/typicode/json-server).


[Find the working solution in this commit](https://github.com/thecanadiandev/react-core-fundamentals/commit/739a16b520298c92b5ef4b2b3b462bde6ca85f95)